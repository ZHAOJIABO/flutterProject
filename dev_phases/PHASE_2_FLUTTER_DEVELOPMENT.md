# 第二阶段：Flutter 前端开发

**时间：第 5-16 周（120-240 小时）**

**状态：** 🟡 未开始

**负责人：** [填写你的名字]

**开始日期：** [填写开始日期]

**预计完成日期：** [填写预计完成日期]

**前置条件：** 完成第一阶段的产品设计和 UI 设计

---

## 📋 阶段目标

搭建完整的 Flutter 项目架构，实现所有核心功能，完成 UI/UX 开发，并进行全面测试。

---

## ✅ 任务清单

### Week 5-6：项目架构搭建（20-40小时）

#### 1. 开发环境配置（3-5小时）

- [ ] **Flutter 环境升级**
  - [ ] 升级 Flutter 到最新稳定版
    ```bash
    flutter upgrade
    flutter doctor
    ```
  - [ ] 检查 Flutter 环境是否正常
  - [ ] 配置国内镜像（如需要）

- [ ] **IDE 配置**
  - [ ] 安装/更新 VSCode 或 Android Studio
  - [ ] 安装 Flutter 和 Dart 插件
  - [ ] 安装 GitHub Copilot（可选）
  - [ ] 配置代码格式化（保存时自动格式化）
  - [ ] 配置代码片段（Snippets）

- [ ] **AI 编程助手**
  - [ ] 安装 Cursor 或 GitHub Copilot
  - [ ] 订阅 ChatGPT Plus 或 Claude Pro
  - [ ] 熟悉 AI 辅助编程的工作流

- [ ] **代码规范配置**
  - [ ] 配置 `analysis_options.yaml`（使用严格模式）
  - [ ] 设置 `.gitignore`
  - [ ] 配置 Git hooks（可选）

**完成标准：**
- Flutter 环境正常运行
- IDE 配置完成，可以正常调试
- 代码规范工具配置完成

---

#### 2. 项目结构重构（8-15小时）

- [ ] **创建新的项目结构**
  - [ ] 使用 AI 生成项目架构方案
  - [ ] 创建分层目录结构（Clean Architecture）
  - [ ] 为每个目录创建 README 说明其职责

**推荐目录结构：**
```
lib/
├── core/                      # 核心层
│   ├── constants/            # 常量（API URL、颜色、字符串等）
│   ├── errors/               # 错误定义和异常处理
│   ├── network/              # 网络请求封装（Dio）
│   ├── storage/              # 本地存储封装（Hive/Sqflite）
│   ├── utils/                # 工具函数（日期、验证等）
│   └── extensions/           # 扩展方法
├── data/                      # 数据层
│   ├── models/               # 数据模型（Freezed + JsonSerializable）
│   ├── repositories/         # 数据仓库实现
│   ├── datasources/          # 数据源（Remote API / Local DB）
│   └── dto/                  # 数据传输对象
├── domain/                    # 业务逻辑层（可选，简单项目可省略）
│   ├── entities/             # 业务实体
│   ├── usecases/             # 用例（业务逻辑）
│   └── repositories/         # 仓库接口
├── presentation/              # 表现层
│   ├── providers/            # 状态管理（Provider/Riverpod）
│   ├── screens/              # 页面
│   ├── widgets/              # 通用组件
│   └── theme/                # 主题配置
├── routes/                    # 路由配置
├── config/                    # 应用配置（环境变量等）
└── main.dart
```

- [ ] **迁移现有代码**
  - [ ] 将现有的 models 迁移到新结构
  - [ ] 将 providers 迁移到新结构
  - [ ] 将 screens 迁移到新结构
  - [ ] 将 services 迁移到新结构
  - [ ] 测试迁移后的功能是否正常

**完成标准：**
- 完整的项目目录结构
- 每个目录都有 README 说明
- 现有代码已迁移且功能正常

---

#### 3. 依赖管理和配置（4-8小时）

- [ ] **更新 pubspec.yaml**
  - [ ] 添加必要的依赖包
  - [ ] 设置版本约束
  - [ ] 运行 `flutter pub get`

**推荐依赖包：**
```yaml
dependencies:
  flutter:
    sdk: flutter

  # 状态管理（二选一）
  provider: ^6.1.1
  # riverpod: ^2.4.0  # 更现代的选择

  # 网络请求
  dio: ^5.4.0
  # retrofit: ^4.0.3  # 可选：类型安全的 API 客户端

  # 本地存储
  hive: ^2.2.3
  hive_flutter: ^1.1.0
  # 或使用 sqflite: ^2.3.0
  shared_preferences: ^2.2.2

  # 路由导航
  go_router: ^13.0.0

  # 数据类生成
  freezed_annotation: ^2.4.1
  json_annotation: ^4.8.1

  # UI 工具
  flutter_screenutil: ^5.9.0    # 屏幕适配
  cached_network_image: ^3.3.0  # 图片缓存
  shimmer: ^3.0.0               # 骨架屏
  flutter_svg: ^2.0.9           # SVG 支持

  # 工具库
  logger: ^2.0.0                # 日志
  intl: ^0.19.0                 # 国际化和日期格式化
  uuid: ^4.3.3                  # UUID 生成
  equatable: ^2.0.5             # 简化对象比较

dev_dependencies:
  flutter_test:
    sdk: flutter
  flutter_lints: ^5.0.0

  # 代码生成
  build_runner: ^2.4.7
  freezed: ^2.4.6
  json_serializable: ^6.7.1
  # retrofit_generator: ^8.0.6

  # 测试
  mockito: ^5.4.4
  integration_test:
    sdk: flutter
```

- [ ] **环境配置**
  - [ ] 创建 `.env` 文件（存储 API URL 等）
  - [ ] 配置 dev 和 prod 环境
  - [ ] 使用 `flutter_dotenv` 或类似包管理环境变量

**完成标准：**
- 所有依赖包正常安装
- 环境配置文件创建完成
- 项目可以正常编译运行

---

#### 4. 基础设施搭建（9-20小时）

- [ ] **网络请求层封装**
  - [ ] 创建 Dio 实例配置
  - [ ] 实现请求拦截器（添加 Token、通用 Headers）
  - [ ] 实现响应拦截器（错误处理、日志记录）
  - [ ] 封装统一的请求方法（GET/POST/PUT/DELETE）
  - [ ] 实现 Token 自动刷新机制（如需要）
  - [ ] 测试网络请求是否正常

- [ ] **本地存储方案**
  - [ ] 选择存储方案（Hive 或 Sqflite）
  - [ ] 初始化本地数据库
  - [ ] 封装 CRUD 操作
  - [ ] 实现数据迁移方案
  - [ ] 测试存储和读取功能

- [ ] **路由管理**
  - [ ] 配置 go_router
  - [ ] 定义所有路由路径（constants）
  - [ ] 实现页面跳转逻辑
  - [ ] 配置路由守卫（如需要登录验证）
  - [ ] 实现深链接（可选）

- [ ] **日志系统**
  - [ ] 集成 Logger 包
  - [ ] 配置日志级别（Debug/Info/Warning/Error）
  - [ ] 实现日志文件存储（可选）
  - [ ] 在关键位置添加日志

- [ ] **错误处理机制**
  - [ ] 定义统一的错误类型
  - [ ] 实现全局错误捕获
  - [ ] 创建用户友好的错误提示
  - [ ] 集成错误上报（Sentry/Firebase Crashlytics，可选）

**完成标准：**
- 网络请求层可以正常工作
- 本地存储可以正常读写
- 路由导航功能完整
- 日志和错误处理机制完善

---

### Week 7-12：核心功能开发（60-120小时）

> 根据你的产品功能，这部分需要具体规划。以下是通用的开发流程。

#### 5. 用户认证系统（如需要）（Week 7-8，20-40小时）

- [ ] **数据模型**
  - [ ] 创建 User 模型（使用 Freezed）
  - [ ] 创建登录请求/响应 DTO
  - [ ] 创建注册请求/响应 DTO

- [ ] **数据层**
  - [ ] 实现认证 API 接口（登录/注册/登出）
  - [ ] 实现 Token 本地存储
  - [ ] 实现用户信息本地缓存

- [ ] **状态管理**
  - [ ] 创建 AuthProvider
  - [ ] 管理登录状态（未登录/登录中/已登录）
  - [ ] 管理用户信息
  - [ ] 实现自动登录（Token 验证）

- [ ] **UI 实现**
  - [ ] 登录页面
    - [ ] 邮箱/手机号输入
    - [ ] 密码输入（支持显示/隐藏）
    - [ ] 记住我选项
    - [ ] 登录按钮（加载状态）
    - [ ] 跳转注册/找回密码链接
  - [ ] 注册页面
    - [ ] 用户名/邮箱/手机号输入
    - [ ] 密码输入（强度提示）
    - [ ] 确认密码
    - [ ] 验证码（如需要）
    - [ ] 用户协议和隐私政策勾选
    - [ ] 注册按钮
  - [ ] 找回密码页面（如需要）

- [ ] **功能测试**
  - [ ] 测试登录流程
  - [ ] 测试注册流程
  - [ ] 测试输入验证（邮箱格式、密码强度等）
  - [ ] 测试错误处理（网络错误、密码错误等）
  - [ ] 测试自动登录

**完成标准：**
- 用户可以正常注册和登录
- Token 正确存储和使用
- 登录状态正确管理
- 错误提示友好清晰

---

#### 6. 核心功能模块开发（Week 9-12，40-80小时）

> 这部分需要根据你的具体产品功能来规划。以下是一个通用的开发流程模板。

**为每个核心功能重复以下步骤：**

- [ ] **功能 1：[功能名称]**（预计 XX 小时）

  **Step 1：功能分析**
  - [ ] 使用 AI 分解功能为子任务
  - [ ] 确定需要的数据模型
  - [ ] 设计 API 接口（如需要）
  - [ ] 规划状态管理方案
  - [ ] 列出可能的边界情况

  **Step 2：数据模型**
  - [ ] 创建数据模型类（Freezed + JsonSerializable）
  - [ ] 运行代码生成：`flutter pub run build_runner build`
  - [ ] 编写模型测试

  **Step 3：数据层**
  - [ ] 创建 Repository 接口
  - [ ] 实现 Repository（调用 API 或本地数据库）
  - [ ] 编写 Repository 测试

  **Step 4：状态管理**
  - [ ] 创建 Provider/Notifier 类
  - [ ] 实现业务逻辑（CRUD 操作）
  - [ ] 管理 UI 状态（加载/成功/错误）
  - [ ] 编写状态管理测试

  **Step 5：UI 实现**
  - [ ] 创建页面 Widget
  - [ ] 实现主要 UI 布局（参考设计稿）
  - [ ] 连接状态管理
  - [ ] 实现加载状态展示（Shimmer/CircularProgressIndicator）
  - [ ] 实现错误状态展示
  - [ ] 实现空状态展示
  - [ ] 添加交互反馈（按钮点击效果、Toast 提示等）

  **Step 6：功能完善**
  - [ ] 实现下拉刷新（如适用）
  - [ ] 实现分页加载（如适用）
  - [ ] 实现搜索和筛选（如适用）
  - [ ] 实现排序功能（如适用）
  - [ ] 添加动画效果

  **Step 7：测试**
  - [ ] 单元测试（模型、Repository、Provider）
  - [ ] Widget 测试（页面 UI）
  - [ ] 手动测试各种场景（正常、异常、边界）
  - [ ] 性能测试（列表滑动流畅度）

  **Step 8：代码审查**
  - [ ] 使用 AI 审查代码（检查 bug、优化性能）
  - [ ] 重构冗余代码
  - [ ] 添加注释和文档
  - [ ] 提交代码到 Git

**完成标准（每个功能）：**
- 功能完整可用
- UI 符合设计稿
- 代码有注释和文档
- 单元测试覆盖率 > 60%
- 无明显性能问题

---

**典型功能开发示例：**

**功能示例 1：列表页面（带搜索、筛选、分页）**
- [ ] 实现数据获取和缓存
- [ ] 实现下拉刷新
- [ ] 实现上拉加载更多
- [ ] 实现搜索功能（防抖）
- [ ] 实现筛选功能（多条件）
- [ ] 实现排序功能
- [ ] 优化列表性能（ListView.builder、const Widget）

**功能示例 2：详情页面**
- [ ] 实现数据获取
- [ ] 实现页面布局（图文混排）
- [ ] 实现操作按钮（收藏、分享、编辑等）
- [ ] 实现 Hero 动画（从列表跳转）
- [ ] 实现相关推荐（如适用）

**功能示例 3：创建/编辑页面**
- [ ] 实现表单输入（文本、数字、日期、图片等）
- [ ] 实现输入验证（实时验证和提交验证）
- [ ] 实现图片上传（拍照/相册选择）
- [ ] 实现草稿保存
- [ ] 实现提交功能
- [ ] 处理提交失败的情况

---

### Week 13-14：UI/UX 完善（20-40小时）

#### 7. 视觉细节优化（8-15小时）

- [ ] **主题系统**
  - [ ] 实现浅色主题
  - [ ] 实现深色主题
  - [ ] 支持主题切换
  - [ ] 测试所有页面的深色模式

- [ ] **动画效果**
  - [ ] 页面转场动画（路由动画）
  - [ ] Hero 动画（列表到详情）
  - [ ] 微动效（按钮点击、卡片翻转等）
  - [ ] 加载动画（优雅的 Shimmer 效果）
  - [ ] 下拉刷新动画

- [ ] **响应式布局**
  - [ ] 适配不同屏幕尺寸（使用 ScreenUtil）
  - [ ] 平板布局优化（如需要）
  - [ ] 横屏布局优化（如需要）
  - [ ] 测试各种设备

- [ ] **细节打磨**
  - [ ] 统一颜色、字体、间距
  - [ ] 优化图标大小和颜色
  - [ ] 调整按钮大小和点击区域
  - [ ] 优化文本对齐和行高
  - [ ] 检查所有边距和圆角

**完成标准：**
- 深色模式完美支持
- 动画流畅自然
- 响应式布局正常
- 视觉细节精致

---

#### 8. 用户体验优化（8-15小时）

- [ ] **空状态设计**
  - [ ] 设计空状态插图（使用 AI 生成）
  - [ ] 编写友好的空状态文案
  - [ ] 添加操作引导（如"去添加第一个项目"）
  - [ ] 实现到所有适用页面

- [ ] **错误处理**
  - [ ] 网络错误提示（带重试按钮）
  - [ ] 服务器错误提示
  - [ ] 权限错误提示
  - [ ] 表单验证错误提示
  - [ ] 统一错误文案风格

- [ ] **加载状态**
  - [ ] 首次加载状态（全屏 Shimmer）
  - [ ] 刷新加载状态（下拉刷新指示器）
  - [ ] 分页加载状态（底部加载指示器）
  - [ ] 按钮加载状态（防止重复提交）

- [ ] **操作反馈**
  - [ ] 成功提示（Toast/SnackBar）
  - [ ] 失败提示
  - [ ] 确认对话框（删除等危险操作）
  - [ ] 按钮点击反馈（水波纹效果）

- [ ] **引导和帮助**
  - [ ] 首次使用引导页（可选）
  - [ ] 功能引导提示（Tooltip）
  - [ ] 帮助文档或 FAQ（如需要）

**完成标准：**
- 空状态友好清晰
- 错误提示准确易懂
- 加载状态体验流畅
- 操作反馈及时明确

---

#### 9. 性能优化（4-10小时）

- [ ] **图片优化**
  - [ ] 使用 `cached_network_image` 缓存网络图片
  - [ ] 实现图片懒加载
  - [ ] 压缩图片质量（上传前）
  - [ ] 使用 WebP 格式（如适用）

- [ ] **列表优化**
  - [ ] 使用 `ListView.builder`（避免 ListView）
  - [ ] 使用 `const` 构造函数
  - [ ] 避免不必要的 Widget 重建
  - [ ] 实现列表项复用

- [ ] **状态管理优化**
  - [ ] 使用 `select` 精确监听状态变化
  - [ ] 避免全局状态重建
  - [ ] 合理划分 Provider 粒度

- [ ] **包体积优化**
  - [ ] 移除未使用的资源
  - [ ] 压缩图片
  - [ ] 使用 `--split-debug-info` 和 `--obfuscate`

- [ ] **性能检测**
  - [ ] 使用 Flutter DevTools 分析性能
  - [ ] 检查是否有内存泄漏
  - [ ] 测试帧率是否稳定 60fps
  - [ ] 优化发现的性能瓶颈

**完成标准：**
- 应用启动时间 < 3秒
- 列表滑动流畅 60fps
- 内存占用合理 < 200MB
- 包体积优化到最小

---

### Week 15-16：集成测试与调试（20-40小时）

#### 10. 测试覆盖（10-20小时）

- [ ] **单元测试**
  - [ ] 测试所有 Model 类
  - [ ] 测试所有 Repository
  - [ ] 测试所有 Provider
  - [ ] 测试工具函数
  - [ ] 运行测试并查看覆盖率：`flutter test --coverage`
  - [ ] 目标覆盖率 > 70%

- [ ] **Widget 测试**
  - [ ] 测试主要页面的 UI 渲染
  - [ ] 测试用户交互（按钮点击、输入等）
  - [ ] 测试不同状态下的 UI（加载/成功/错误）
  - [ ] 至少覆盖 5 个主要页面

- [ ] **集成测试**
  - [ ] 编写关键用户流程的集成测试
  - [ ] 测试登录 → 主页 → 详情的完整流程
  - [ ] 测试创建/编辑/删除的完整流程
  - [ ] 在真机上运行集成测试

- [ ] **测试报告**
  - [ ] 生成测试覆盖率报告
  - [ ] 记录所有测试用例
  - [ ] 记录已知问题和限制

**完成标准：**
- 单元测试覆盖率 > 70%
- 主要页面有 Widget 测试
- 核心流程有集成测试
- 所有测试通过

---

#### 11. Bug 修复和调试（10-20小时）

- [ ] **Bug 收集**
  - [ ] 自己测试并记录所有 bug
  - [ ] 邀请 3-5 个朋友测试
  - [ ] 收集用户反馈的问题
  - [ ] 创建 Bug 清单（优先级分类）

- [ ] **Bug 修复**
  - [ ] 修复 P0（严重）bug（崩溃、数据丢失）
  - [ ] 修复 P1（重要）bug（功能不可用、严重体验问题）
  - [ ] 修复 P2（一般）bug（小问题、体验优化）
  - [ ] 对每个 bug 编写回归测试

- [ ] **兼容性测试**
  - [ ] 在 iOS 真机测试（至少 1 台）
  - [ ] 在 Android 真机测试（至少 2 台不同品牌）
  - [ ] 测试不同屏幕尺寸
  - [ ] 测试不同系统版本

- [ ] **最终检查**
  - [ ] 检查所有功能是否正常
  - [ ] 检查所有页面是否美观
  - [ ] 检查是否有遗漏的设计细节
  - [ ] 检查是否有控制台警告或错误

**完成标准：**
- 所有 P0 和 P1 bug 已修复
- 在 iOS 和 Android 上测试通过
- 无明显的 UI 问题
- 无控制台错误

---

## 🤖 本阶段需要问 AI 的问题

### 项目架构阶段

**问题 1：生成项目架构**
```
我需要为 Flutter 项目创建一个清晰的分层架构（Clean Architecture）。

项目信息：
- 应用类型：[工具类/社交类/...]
- 主要功能：[列出 5-8 个核心功能]
- 是否需要后端：[是/否]
- 状态管理方案：Provider

请帮我：
1. 生成完整的目录结构（lib/ 下的所有文件夹）
2. 为每个目录编写 README，说明其职责
3. 给出关键文件的代码模板：
   - 网络请求封装（Dio + 拦截器）
   - 本地存储封装（Hive）
   - 路由配置（go_router）
   - 错误处理机制
4. 说明数据流向（从 API 到 UI 的完整流程）

输出格式：详细的项目架构文档 + 代码模板
```

**问题 2：依赖包选择**
```
我的 Flutter 项目需要以下功能：
[列出功能需求]

请帮我：
1. 推荐合适的依赖包（包名 + 版本）
2. 对比不同方案的优缺点（如 Provider vs Riverpod）
3. 说明每个包的用途和必要性
4. 提供完整的 pubspec.yaml 配置
5. 指出可能的依赖冲突和解决方案

输出格式：详细的依赖包推荐文档 + pubspec.yaml
```

---

### 功能开发阶段

**问题 3：功能分解和规划**
```
我需要实现 [功能名称] 功能。

功能描述：[详细描述功能需求]

用户场景：[描述用户如何使用这个功能]

请帮我：
1. 分解为具体的开发子任务（估算每个任务时间）
2. 确定需要哪些数据模型（Model 类）
3. 设计 API 接口（如需要后端）
4. 规划状态管理方案（需要哪些 Provider）
5. 列出可能的边界情况和异常处理
6. 提供开发顺序建议（先做什么后做什么）

输出格式：详细的功能开发计划（任务清单 + 技术方案）
```

**问题 4：生成完整功能代码**
```
我需要创建一个 Flutter 页面：[功能描述]

技术栈：
- 状态管理：Provider
- 网络请求：Dio
- 本地存储：Hive

功能需求：
- [列出具体需求，如"显示列表"、"支持搜索"、"分页加载"等]

API 接口：
- 接口地址：[URL]
- 请求方法：[GET/POST/...]
- 请求参数：[参数列表]
- 响应格式：[JSON 结构]

UI 要求：
- [描述 UI 布局和交互]

请生成完整代码，包括：
1. Model 类（使用 Freezed + JsonSerializable）
2. Repository 类（API 调用和错误处理）
3. Provider 类（状态管理，包含加载/成功/错误三种状态）
4. Screen Widget（完整的页面 UI）
5. 必要的自定义 Widget（如列表项）

要求：
- 代码包含详细注释
- 遵循 Flutter 最佳实践
- 包含错误处理和边界情况
- 考虑性能优化（const、ListView.builder 等）
- 符合 Material Design 3 规范

输出格式：完整可运行的代码 + 文件结构说明
```

**问题 5：代码审查和优化**
```
以下是我写的 [功能名称] 代码：

```dart
[粘贴你的代码]
```

请帮我：
1. 检查潜在的 bug 和逻辑错误
2. 优化性能（避免不必要的 Widget 重建）
3. 改进代码结构和可读性
4. 检查是否遵循 Flutter 最佳实践
5. 添加必要的错误处理和边界情况处理
6. 建议需要写的测试用例

请按以下格式输出：
- 问题等级：P0（严重）/ P1（重要）/ P2（建议）
- 问题描述
- 修复建议
- 改进后的代码

输出格式：代码审查报告 + 优化后的代码
```

---

### UI/UX 开发阶段

**问题 6：设计稿转代码**
```
我有一个设计稿，需要转换为 Flutter 代码。

设计描述：
[详细描述设计，或上传设计稿图片]

页面元素：
- [列出所有 UI 元素，如标题、图片、按钮等]

交互要求：
- [描述交互行为，如点击、滑动等]

请帮我：
1. 分析页面的组件结构（哪些是容器/列表/卡片等）
2. 提供完整的 Widget 树结构
3. 给出关键组件的代码实现
4. 标注颜色/字体/间距的具体数值
5. 建议响应式布局方案
6. 实现动画效果（如有）

要求：
- 使用 Material Design 3 组件
- 代码包含详细注释
- 考虑性能优化（const 构造函数）
- 适配深色模式

输出格式：完整的 Flutter 代码 + Widget 结构图
```

**问题 7：动画实现**
```
我想为 [页面/组件] 添加动画效果。

当前行为：[描述现状]
期望效果：[描述期望的动画效果]

参考示例：[提供参考链接或描述类似的效果]

请提供 Flutter 动画实现代码，包括：
1. 合适的 AnimationController 设置
2. Tween 和 Curve 配置
3. 完整的动画代码
4. 性能优化建议
5. 使用说明

输出格式：完整的动画代码 + 使用示例
```

---

### 性能优化阶段

**问题 8：性能分析和优化**
```
我的 Flutter 应用有性能问题：

问题描述：
- [描述性能问题，如"列表滑动卡顿"、"启动慢"等]

相关代码：
```dart
[粘贴相关代码]
```

Flutter DevTools 数据：
- [提供性能数据或截图]

请帮我：
1. 分析可能的性能瓶颈
2. 提供详细的优化方案（代码级别）
3. 说明优化原理
4. 给出优化前后的性能对比预期
5. 提供 Flutter 性能优化最佳实践

输出格式：性能分析报告 + 优化代码 + 最佳实践文档
```

**问题 9：包体积优化**
```
我的应用包体积过大（XX MB）。

当前配置：
- Flutter 版本：[版本]
- 依赖包：[列出主要依赖]
- 资源文件：[描述图片、字体等资源]

请提供包体积优化方案：
1. 如何分析包内容（哪些文件占用大）
2. 图片资源优化建议（格式、压缩等）
3. 代码优化建议（Tree Shaking、混淆等）
4. 依赖包优化建议（是否有更轻量的替代）
5. 配置文件调整（build.gradle、Xcode 配置）
6. 预期能减少多少体积

输出格式：详细的优化方案 + 配置文件 + 预期效果
```

---

### 测试阶段

**问题 10：生成测试用例**
```
为以下 Dart 类生成完整的单元测试：

```dart
[粘贴你的代码]
```

要求：
1. 测试所有公共方法
2. 包含正常情况和异常情况
3. 包含边界情况测试
4. 使用 Mockito mock 依赖（如有）
5. 清晰的测试描述和分组（group/test）
6. 使用 setUp 和 tearDown 管理测试状态

输出格式：完整的测试代码（test/ 目录下的文件）
```

**问题 11：集成测试**
```
我需要测试以下用户流程：

流程描述：
1. [步骤1：如"打开应用"]
2. [步骤2：如"点击登录按钮"]
3. [步骤3：如"输入用户名和密码"]
...

涉及的页面：
- [列出所有相关页面]

请生成 Flutter 集成测试代码（integration_test），包括：
1. 完整的测试代码
2. 用户操作模拟（tap、enterText、scroll 等）
3. 断言检查（验证 UI 元素和状态）
4. 等待机制（处理异步操作）
5. 截图保存（关键步骤）

输出格式：完整的集成测试代码 + 运行说明
```

---

### 调试和问题解决

**问题 12：Bug 调试**
```
我的 Flutter 应用遇到以下错误：

错误信息：
[粘贴完整的错误堆栈]

相关代码：
```dart
[粘贴相关代码]
```

复现步骤：
1. [步骤1]
2. [步骤2]
...

请帮我：
1. 分析错误原因
2. 提供详细的调试步骤
3. 给出修复方案（代码级别）
4. 说明如何避免类似问题
5. 提供测试用例（防止回归）

输出格式：问题分析 + 修复代码 + 预防措施
```

**问题 13：最佳实践咨询**
```
我想了解 [主题] 的 Flutter 最佳实践。

主题示例：
- 状态管理
- 错误处理
- 网络请求
- 本地存储
- 性能优化
- ...

请提供：
1. 官方推荐的最佳实践
2. 常见的错误做法（Anti-patterns）
3. 代码示例（好的和坏的对比）
4. 工具和资源推荐
5. 实际项目中的应用建议

输出格式：详细的最佳实践文档 + 代码示例
```

---

## 📊 本阶段交付物清单

### 代码类

- [ ] 完整的项目架构代码
- [ ] 所有核心功能的实现代码
- [ ] 所有页面的 UI 代码
- [ ] 路由配置代码
- [ ] 主题配置代码
- [ ] 单元测试代码（覆盖率 > 70%）
- [ ] Widget 测试代码（主要页面）
- [ ] 集成测试代码（核心流程）

### 文档类

- [ ] 项目架构文档
- [ ] API 接口文档（如有后端）
- [ ] 功能开发记录
- [ ] 测试报告和覆盖率数据
- [ ] 已知问题和限制清单
- [ ] 性能优化报告

### 资源类

- [ ] 应用图标（多种尺寸）
- [ ] 启动屏幕
- [ ] 图片资源（优化后）
- [ ] 字体文件（如有自定义字体）

---

## 🎯 完成标准

### 最低标准（必须完成）

- ✅ 所有 MVP 功能已实现且可正常使用
- ✅ UI 基本符合设计稿
- ✅ 无 P0（严重）bug
- ✅ 在 iOS 和 Android 上测试通过
- ✅ 代码已提交到 Git

### 理想标准（推荐完成）

- ✅ 所有功能完美实现
- ✅ UI 完全符合设计稿，细节精致
- ✅ 无 P1（重要）bug
- ✅ 单元测试覆盖率 > 70%
- ✅ 主要页面有 Widget 测试
- ✅ 核心流程有集成测试
- ✅ 性能优化完成（60fps、启动快）
- ✅ 深色模式完美支持
- ✅ 代码有完整注释和文档

---

## ⚠️ 常见问题和注意事项

### 开发过程中的常见陷阱

1. **过度设计**：不要在架构上花费太多时间，先实现功能再优化
2. **完美主义**：不要纠结于细节，先完成 80% 再追求 100%
3. **忽视测试**：不要觉得测试浪费时间，它会节省你调试的时间
4. **性能忽视**：不要等到最后才关注性能，开发时就要注意
5. **状态管理混乱**：规划好状态管理方案，不要随意传递状态

### Flutter 开发最佳实践

**Widget 设计：**
- 尽可能使用 `const` 构造函数
- 大 Widget 拆分成小 Widget
- 使用 `ListView.builder` 而不是 `ListView`
- 避免在 `build` 方法中执行耗时操作

**状态管理：**
- 状态尽可能放在靠近使用它的地方
- 使用 `select` 精确监听状态变化
- 避免全局状态重建
- 合理划分 Provider 粒度

**性能优化：**
- 使用 `cached_network_image` 缓存图片
- 避免不必要的 Widget 重建（使用 `const`、`key`）
- 使用 `Isolate` 处理耗时计算
- 定期使用 Flutter DevTools 检查性能

**代码质量：**
- 遵循 Dart 代码规范
- 使用有意义的命名
- 添加必要的注释
- 定期重构代码

### 调试技巧

**常用调试方法：**
1. **print 调试**：快速查看变量值
2. **debugPrint**：更好的日志输出
3. **断点调试**：使用 IDE 的断点功能
4. **Flutter DevTools**：分析性能、内存、网络
5. **Hot Reload**：快速预览修改效果

**常见错误和解决方案：**
- **Widget 重建频繁**：检查是否使用了 `const`，是否有不必要的 `setState`
- **列表滑动卡顿**：使用 `ListView.builder`，检查列表项是否过于复杂
- **网络请求失败**：检查网络权限、HTTPS 证书、API 地址
- **状态丢失**：检查 Widget 的 `key`，检查状态管理方式

---

## 📝 本阶段工作日志

### Week 5-6：项目架构搭建

**[日期] Week 5 Day 1**
- 完成了：
- 遇到的问题：
- 明天计划：

**[日期] Week 5 Day 2**
- 完成了：
- 遇到的问题：
- 明天计划：

### Week 7-12：核心功能开发

**[日期] Week 7 Day 1**
- 完成了：
- 遇到的问题：
- 明天计划：

### Week 13-14：UI/UX 完善

**[日期] Week 13 Day 1**
- 完成了：
- 遇到的问题：
- 明天计划：

### Week 15-16：测试与调试

**[日期] Week 15 Day 1**
- 完成了：
- 遇到的问题：
- 明天计划：

---

## 🔄 阶段回顾

**完成日期：** [填写实际完成日期]

**实际用时：** [填写实际小时数]

**完成度：** [ ]%

### 做得好的地方

1.
2.
3.

### 需要改进的地方

1.
2.
3.

### 技术难点和解决方案

1. **问题：**
   - 解决方案：

2. **问题：**
   - 解决方案：

### 经验教训

1.
2.
3.

### 下一阶段注意事项

1.
2.
3.

---

## 🔗 相关资源

### 推荐工具

- **IDE**：VSCode / Android Studio
- **AI 助手**：GitHub Copilot / Cursor / Claude Code
- **调试工具**：Flutter DevTools
- **测试工具**：Flutter Test / Integration Test
- **代码质量**：Flutter Lints / Dart Analyzer

### 学习资源

- [Flutter 官方文档](https://flutter.dev/docs)
- [Flutter Cookbook](https://docs.flutter.dev/cookbook)
- [Flutter Widget 目录](https://docs.flutter.dev/ui/widgets)
- [Pub.dev](https://pub.dev/) - Flutter 包仓库
- [Flutter Community](https://flutter.dev/community)

### 常用命令速查

```bash
# 创建项目
flutter create my_app

# 运行项目
flutter run

# 热重载
r

# 热重启
R

# 清理构建
flutter clean

# 获取依赖
flutter pub get

# 代码生成（Freezed/JsonSerializable）
flutter pub run build_runner build --delete-conflicting-outputs

# 代码生成（监听模式）
flutter pub run build_runner watch

# 运行测试
flutter test

# 运行测试并生成覆盖率
flutter test --coverage

# 分析代码
flutter analyze

# 打包 APK
flutter build apk --release

# 打包 iOS
flutter build ios --release

# 查看设备
flutter devices

# 查看 Flutter 版本
flutter --version

# 升级 Flutter
flutter upgrade

# 检查 Flutter 环境
flutter doctor
```

---

**上一阶段：** [PHASE_1_PRODUCT_DESIGN.md](./PHASE_1_PRODUCT_DESIGN.md)

**下一阶段：** [PHASE_3_BACKEND_DEVELOPMENT.md](./PHASE_3_BACKEND_DEVELOPMENT.md)
